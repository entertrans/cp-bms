<!-- Slider -->
<div id="main-slider" class="dl-slider">
    <div class="single-slide">
        <div class="bg-img kenburns-top-right" style="background-image: url(<?= base_url('assets/mockup/core/img/slider-1.jpg') ?>);"></div>
        <div class="overlay"></div>
        <div class="slider-content-wrap d-flex align-items-center text-left">
            <div class="container">
                <div class="slider-content">
                    <div class="dl-caption medium">
                        <div class="inner-layer">
                            <div data-animation="fade-in-right" data-delay="1s">Residencial</div>
                        </div>
                    </div>
                    <div class="dl-caption big">
                        <div class="inner-layer">
                            <div data-animation="fade-in-left" data-delay="2s">We provide outstanding</div>
                        </div>
                    </div>
                    <div class="dl-caption big">
                        <div class="inner-layer">
                            <div data-animation="fade-in-left" data-delay="2.5s">construction services.</div>
                        </div>
                    </div>
                    <div class="dl-caption small">
                        <div class="inner-layer">
                            <div data-animation="fade-in-left" data-delay="3s">We have provided complete remodeling and construction solutions for <br>residential and commercial properties in cities.</div>
                        </div>
                    </div>
                    <div class="dl-btn-group">
                        <div class="inner-layer">
                            <a href="#" class="dl-btn" data-animation="fade-in-left" data-delay="3.5s">View Projects <i class="arrow_right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="single-slide">
        <div class="bg-img kenburns-top-right" style="background-image: url(<?= base_url('assets/mockup/core/img/slider-2.jpg') ?>);"></div>
        <div class="overlay"></div>
        <div class="slider-content-wrap d-flex align-items-center text-center">
            <div class="container">
                <div class="slider-content">
                    <div class="dl-caption medium">
                        <div class="inner-layer">
                            <div data-animation="fade-in-top" data-delay="1s">Residencial</div>
                        </div>
                    </div>
                    <div class="dl-caption big">
                        <div class="inner-layer">
                            <div data-animation="fade-in-bottom" data-delay="2s">We are professional</div>
                        </div>
                    </div>
                    <div class="dl-caption big">
                        <div class="inner-layer">
                            <div data-animation="fade-in-bottom" data-delay="2.5s">for building construction.</div>
                        </div>
                    </div>
                    <div class="dl-caption small">
                        <div class="inner-layer">
                            <div data-animation="fade-in-bottom" data-delay="3s">We have provided complete remodeling and construction solutions for <br>residential and commercial properties in cities.</div>
                        </div>
                    </div>
                    <div class="dl-btn-group">
                        <div class="inner-layer">
                            <a href="#" class="dl-btn" data-animation="fade-in-bottom" data-delay="3.5s">View Projects <i class="arrow_right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="single-slide">
        <div class="bg-img kenburns-top-right" style="background-image: url(<?= base_url('assets/mockup/core/img/slider-3.jpg') ?>);"></div>
        <div class="overlay"></div>
        <div class="slider-content-wrap d-flex align-items-center text-right">
            <div class="container">
                <div class="slider-content">
                    <div class="dl-caption medium">
                        <div class="inner-layer">
                            <div data-animation="fade-in-left" data-delay="1s">Residencial</div>
                        </div>
                    </div>
                    <div class="dl-caption big">
                        <div class="inner-layer">
                            <div data-animation="fade-in-right" data-delay="2s">We will be happy to take care</div>
                        </div>
                    </div>
                    <div class="dl-caption big">
                        <div class="inner-layer">
                            <div data-animation="fade-in-right" data-delay="2.5s">of your construction works.</div>
                        </div>
                    </div>
                    <div class="dl-caption small">
                        <div class="inner-layer">
                            <div data-animation="fade-in-right" data-delay="3s">We have provided complete remodeling and construction solutions for <br>residential and commercial properties in cities.</div>
                        </div>
                    </div>
                    <div class="dl-btn-group">
                        <div class="inner-layer">
                            <a href="#" class="dl-btn" data-animation="fade-in-right" data-delay="3.5s">View Projects <i class="arrow_right"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- ./slider -->

<!-- about -->
<!-- <section class="about-section padding">
    <div class="container">
        <div class="row about-wrap">
            <div class="col-lg-6 sm-padding">
                <div class="about-content wow fadeInLeft">
                    <h2>We are the expart on this field better solution since 1984.</h2>
                    <p>We are committed to building a sustainable future by fostering a collaborative spirit that creates exceptional experiences, balanced relationships, and community built environment. Building isnâ€™t just job. It's our passion. With every project we undertake, we set the bar high and provide the best industry.</p>
                    <a href="#" class="default-btn">More About Us</a>
                </div>
            </div>
            <div class="col-lg-6 sm-padding">
                <ul class="about-promo">
                    <li class="about-promo-item wow fadeInUp">
                        <i class="flaticon-factory"></i>
                        <div>
                            <h3>Professional Liability</h3>
                            <p>We are committed to building a sustainable future by fostering a collaborative spirit.</p>
                        </div>
                    </li>
                    <li class="about-promo-item wow fadeInUp" data-wow-delay="300ms">
                        <i class="flaticon-worker"></i>
                        <div>
                            <h3>Dedicated To Our Clients</h3>
                            <p>We are committed to building a sustainable future by fostering a collaborative spirit.</p>
                        </div>
                    </li>
                    <li class="about-promo-item wow fadeInUp" data-wow-delay="500ms">
                        <i class="flaticon-gear"></i>
                        <div>
                            <h3>Outstanding Services</h3>
                            <p>We are committed to building a sustainable future by fostering a collaborative spirit.</p>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section> -->
<!-- ./about -->

<!-- material -->
<section class="blog-section padding">
    <div class="container">
        <div class="section-heading text-center mb-40 wow fadeInUp" data-wow-delay="100ms">
            <!-- <span>From Blog</span> -->
            <h2>Materail</h2>
        </div>
        <div class="row blog-wrap">
            <?php $data = $this->db->select('*')->from('tbl_service')->where('id_serv_desc', 1)->limit(3)->get()->result_array();
            foreach ($data as $dt) : ?>
                <div class="col-lg-4 col-sm-6 sm-padding">
                    <div class="blog-item box-shadow">
                        <div class="blog-thumb">
                            <img src="<?= base_url('assets/mockup/core/img/produk/') . $dt['foto'] ?>" alt="<?= $dt['nm_service'] ?>" style=" width: 400px; height: 250px">
                            <div class="middle">
                                <div class="btn btn-outline-primary btn-lg view" data-id="<?= $dt['id'] ?>"><i class="fa fa-fw fa-eye"></i></div>
                            </div>
                        </div>
                        <div class="blog-content">
                            <h3><?= $dt['nm_service'] ?></h3>
                            <p>[deskripsi-singkat]</p>
                        </div>
                    </div>
                </div>
            <?php endforeach; ?>
        </div>
        <div class="section-heading text-center mt-40 wow fadeInUp" data-wow-delay="100ms">
            <button type="button" class="btn btn-outline-primary btn-lg">View More</button>
        </div>
    </div>
</section>
<!-- ./material -->

<!-- jasa konstruksi -->
<section class="blog-section padding">
    <div class="container">
        <div class="section-heading text-center mb-40 wow fadeInUp" data-wow-delay="100ms">
            <!-- <span>From Blog</span> -->
            <h2>Jasa Konstruksi</h2>
        </div>
        <div class="row blog-wrap">
            <?php $data = $this->db->select('*')->from('tbl_service')->where('id_serv_desc', 2)->limit(3)->get()->result_array();
            foreach ($data as $dt) : ?>
                <div class="col-lg-4 col-sm-6 sm-padding">
                    <div class="blog-item box-shadow">
                        <div class="blog-thumb">
                            <img src="<?= base_url('assets/mockup/core/img/produk/') . $dt['foto'] ?>" alt="<?= $dt['nm_service'] ?>" style="width: 400px; height: 250px">
                            <div class="middle">
                                <div class="btn btn-outline-primary btn-lg view" data-id="<?= $dt['id'] ?>"><i class="fa fa-fw fa-eye"></i></div>
                            </div>
                        </div>
                        <div class="blog-content">
                            <h3><?= $dt['nm_service'] ?></h3>
                            <p>[deskripsi-singkat]</p>
                        </div>
                    </div>
                </div>
            <?php endforeach; ?>
        </div>
        <div class="section-heading text-center mt-40 wow fadeInUp" data-wow-delay="100ms">
            <button type="button" class="btn btn-outline-primary btn-lg">View More</button>
        </div>
    </div>
</section>
<!-- ./jasa konstruksi -->

<!-- The Modal -->
<div class="modal fade" id="myModal" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            <!-- Modal Header -->
            <!-- <div class="modal-header">
                <h4 class="modal-title"></h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div> -->

            <!-- Modal body -->
            <div class="modal-body">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <div class="row">
                    <div class="col-md-4">
                        <div id="imgWarp"></div>
                    </div>
                    <div class="col-md-6">
                        <h3 class="title"></h3>
                        <h5 class="harga"></h5>
                        <p class="desc"></p>
                        <h5>Pilihan</h5>
                        <form id="formOrder">
                            <div class="row">
                                <input type="hidden" id="idService">
                                <div class="col-sm-3">
                                    <div class="form-group">
                                        <input type="number" class="form-control" name="qty" id="qty">
                                    </div>
                                </div>
                                <label class="col-sm-1 col-form-label pl-0">Qty</label>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <select class="form-control" id="satuan"></select>
                                    </div>
                                </div>
                                <label class="col-sm-1 col-form-label pl-0">Satuan</label>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-warning" onclick="cart()" class="fa fa-fw fa-shopping-cart"></i> Add to Cart</button>
            </div>

        </div>
    </div>
</div>

<?php $this->load->view('mockup/layout/core/js'); ?>

<script>
    $('.view').on('click', function() {
        var id = $(this).data('id');
        $('#myModal').modal('show');
        $.ajax({
            url: "<?= site_url('welcome/find/') ?>" + id,
            type: "GET",
            dataType: "JSON",
            success: function(data) {
                var produk = data.produk;
                var satuan = data.satuan;
                var imgUrl = "assets/mockup/core/img/produk/" + produk.foto
                var css = {
                    'height': '200px',
                    'background-image': 'url(' + imgUrl + ')',
                    'background-position': 'center',
                    'background-repeat': 'no-repeat',
                    'background-size': 'cover'
                }

                // $('.modal-title').text(data.nm_service);
                $('#imgWarp').css(css);
                $('#idService').val(produk.id);
                $('.title').text(produk.nm_service);
                // $('.harga').text('Rp. -');
                var text = '';
                for (var i = 0; i < satuan.length; i++) {
                    text += satuan[i].satuan + ' - Rp. ' + numberFormat(satuan[i].harga) + '<br>';
                }
                $('.desc').html('<p>Desc ' + produk.nm_service + '<br>' + text + '</p>');

                var html = '';
                for (var i = 0; i < satuan.length; i++) {
                    html += '<option value="' + satuan[i].harga + '">' + satuan[i].satuan + '</option>';
                }
                $('#satuan').html(html);
            }
        });
    });

    $('.hapus_cart').on('click', function() {
        var row_id = $(this).attr('id');
        $.ajax({
            url: "<?= site_url('checkout/hapus_cart/') ?>" + row_id,
            type: "POST",
            dataType: "JSON",
            data: {
                row_id: row_id
            },
            success: function(data){
                location.reload();
            }
        });
    });

    // $('#myModal').on('click', '#calc', function() {
    //     var id = $('#idService').val();
    //     var harga = $(this).val();
    //     var qty = $('#qty').val();
    //     var calc = harga * qty;

    //     $('.harga').text('Rp. ' + calc);

    //     var data = {
    //         'id': id,
    //         'qty': qty,
    //         'harga': harga,
    //         'total': calc
    //     };

    //     $('#cart').on('click', function() {
    //         cart(data);
    //     });
    // });

    function numberFormat(bilangan) {
        reverse = bilangan.toString().split('').reverse().join(''),
            ribuan = reverse.match(/\d{1,3}/g);
        ribuan = ribuan.join('.').split('').reverse().join('');
        return ribuan;
    }

    function cart() {
        var id = $('#idService').val();
        var name = $('.title').text();
        var harga = $('#satuan').val();
        var satuan = $('#satuan option:selected').text();
        var qty = $('#qty').val();

        if (qty < 1) {
            alert('Harap masukan jumlah Qty');
            return;
        } else {
            var data = {
                'id': id,
                'qty': qty,
                'name': name,
                'harga': harga,
                'satuan': satuan
            };
        }
        // console.log(data);

        $.ajax({
            url: "<?= site_url('welcome/order') ?>",
            type: "POST",
            dataType: "JSON",
            data: data,
            success: function(data) {
                if (data.status) {
                    alert('Data berhasil ditambahkan ke keranjang');
                    $('#myModal').modal('hide');
                    $('#formOrder')[0].reset();
                    location.reload();

                } else {
                    alert('Data tidak berhasil ditambahkan ke keranjang');
                }
            }
        });
    }
</script>